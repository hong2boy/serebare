window.addEventListener('DOMContentLoaded', function() {

const main_BannerCloseTrigger = document.querySelector(".bar-close");
const mainBanner_Id = document.getElementById("mainBanner");
const mainBannerShow_ChangeElement = document.querySelectorAll(".mainBannerShow_ChangeThis");
const header_Id = document.getElementById("header");
var asideActiveIcon = document.querySelector(".menu-ico");
const u_setCookie = function(name, value) {
  document.cookie = name + '=' + value + ';path=/';
};
const u_getCookie = function(name) {
  var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
  return value ? value[2] : null;
};
const bannerConfirm = u_getCookie("bannerClosedConfirm");
if (bannerUse == "on") {
  if (bannerConfirm == null || bannerConfirm == "no") {
    for (var i = 0; i < mainBannerShow_ChangeElement.length; i++) {
      mainBannerShow_ChangeElement[i].classList.add("bannerShow");
    }
    u_setCookie("bannerClosedConfirm", "no");
    header_Id.classList.add("bannerShow");
  }
  main_BannerCloseTrigger.addEventListener("click", function() {
    for (var i = 0; i < mainBannerShow_ChangeElement.length; i++) {
      mainBannerShow_ChangeElement[i].classList.remove("bannerShow");
    }
    u_setCookie("bannerClosedConfirm", "yes");
    header_Id.classList.remove("bannerShow");
  });
} else {
  for (var i = 0; i < mainBannerShow_ChangeElement.length; i++) {
    mainBannerShow_ChangeElement[i].classList.remove("bannerShow");
  }
  u_setCookie("bannerClosedConfirm", "yes");
  header_Id.classList.remove("bannerShow");
}

});
(function($) {
  $(document).ready(function() {

  $(".search-menu").click(function(event) {
    TweenMax.to($(".search-popup"), 1, {
      y: 0
    });
    $(".search-popup").fadeIn('400', function() {
      var popupShip = true;
      $('body').click(function(e) {
        if ($(e.target).closest('.search-popup').length == 0 && popupShip == true || $(e.target).is('.ti-close')) {
          TweenMax.to($(".search-popup"), 1, {
            y: 50
          });
          $(".search-popup").fadeOut('400', function() {
            popupShip = false
          })
        }
      })
    })
  });
  var headerAside = $('.aside');
  socialIcon();

  function socialIcon() {
    if (pd_NaverTalk == "off") {
      $('.unfoldNaverTalkIcon').addClass('offDisplay')
    }
    if (pd_KakaoTalk == "off") {
      $('.unfoldKakaoTalkIcon').addClass('offDisplay')
    }
  }

  function AsideActive() {
    $('.hamburgerIco').addClass('animate');
    $(".open-menu").addClass('active');
    headerAside.addClass('active');
    $(".left-menu").addClass('black-menu')
  };

  function AsideClosed() {
    $('.hamburgerIco').removeClass('animate');
    $(".open-menu").removeClass('active');
    headerAside.removeClass('active');
    if (!$('.left-menu').hasClass('indexNeedBlack')) {
      $(".left-menu").removeClass('black-menu')
    }
  };
  $(document).click(function(e) {
    var getTargetClass = $(e.target).attr("class");
    if (!$('.aside').hasClass('active')) {
      if (getTargetClass == "menu-ico" || getTargetClass == "hamburgerIco") {
        AsideActive();
        $("body").css('overflow', 'hidden')
      }
    } else {
      if (!$(e.target).closest('.aside').length) {
        AsideClosed();
        $("body").css('overflow', 'scroll')
      }
    }
  });
  $(".inviewTrigger").one('inview', function(event) {
    $(this).addClass('on')
  });
  var specTitle = $(".spec").find('.title');
  specTitle.each(function() {
    var getTitleText = $(this).find('span').html();
    if (getTitleText == "사용후기" || getTitleText == "상품문의") {
      $(this).parent("li").hide()
    }
  });
  var scrollPositionMiddle = $(window).height() / 2;
  $(window).resize(function() {
    scrollPositionMiddle = $(window).height() / 2
  });
  $(".quick-arrow-up").on('click', function(e) {
    $('html , body').stop().animate({
      scrollTop: "0"
    }, 500)
  });
  $(".quick-arrow-down").on('click', function(e) {
    var docHeight = $(document).height();
    $('html , body').stop().animate({
      scrollTop: docHeight
    }, 500)
  });
  var qContent = $('.quick-content');
  qContent.each(function() {
    var qCWidth = $(this).width();
    TweenMax.set($(this), {
      x: qCWidth
    })
  });
  $(".quick-icon").on('click', function(e) {
    var qSideBarOn = true;
    var qiconIndex = $(".quick-icon").index(this);
    var qCOn = qContent.eq(qiconIndex);
    var qCOnWidth = qCOn.width();
    qContent.removeClass('active');
    qCOn.addClass('active');
    if (qiconIndex == 0) {
      var recentItemLength = $('.quick-content-00 .xans-record-').length;
      if (recentItemLength > 0) {
        $('.quick-content-00').find('.message').hide()
      }
    }
    TweenMax.to('#quick-wrap', 0.5, {
      x: -qCOnWidth
    });
    $(document).on('click', function(e) {
      if ($(e.target).closest('#quick-wrap').length == 0 && qSideBarOn == true) {
        TweenMax.to('#quick-wrap', 0.5, {
          x: 0
        });
        qSideBarOn = false
      }
    })
  });

  function quickArrow() {
    var scrollPositionTop = $(window).scrollTop();
    if (scrollPositionTop > scrollPositionMiddle) {
      $(".quick-arrow-wrap").removeClass('top');
      $(".quick-arrow-wrap").addClass('middle')
    } else {
      $(".quick-arrow-wrap").removeClass('middle');
      $(".quick-arrow-wrap").addClass('top')
    }
  };
  $(window).scroll(function() {
    quickArrow()
  });
  var headerCategory = new Swiper('#headerCategory', {
    slidesPerView: 'auto',
    freeMode: true,
  });
  var headerCategorySecond = new Swiper('#headerCategorySecond', {
    slidesPerView: 'auto',
    freeMode: true,
  });
  var mainHeader = document.getElementById("header");
  var cate = document.getElementById("category");
  var cateSecond = document.getElementById("categorySecond");
  var prdTab = document.getElementById("tabProduct");
  if (typeof(prdTab) != 'undefined' && prdTab != null) {
    var ptOffset = prdTab.offsetTop;
    var prdHas = true;
    var ptOffsetGet = false
  }
  if (prdHas == true) {
    window.addEventListener('scroll', throttle(prdScrollHandler, 50));
  } else {
    window.addEventListener('scroll', throttle(mainScrollHeader, 50));
  }

  function throttle(callback, limit) {
    var wait = false;
    return function() {
      if (!wait) {
        callback.apply(null, arguments);
        wait = true;
        setTimeout(function() {
          wait = false
        }, limit)
      }
    }
  }

  function mainScrollHeader() {
    var scrollPos = window.pageYOffset;
    if (scrollPos > 100) {
      mainHeader.classList.add('on');
    } else {
      mainHeader.classList.remove('on');
    }
  }

  function prdScrollHandler() {
    var scrollPos = window.pageYOffset;
    if (scrollPos > 100) {
      mainHeader.classList.add('on');
      cate.classList.add('on');
      cateSecond.classList.add('on');
      if (!prdTab.classList.contains('on') && ptOffsetGet == false) {
        ptOffset = prdTab.offsetTop;
        ptOffsetGet = true
      }
    } else {
      mainHeader.classList.remove('on');
      cate.classList.remove('on');
      cateSecond.classList.remove('on');
    }
    if (scrollPos + 100 > ptOffset) {
      prdTab.classList.add("on")
    } else {
      prdTab.classList.remove("on")
    }
  }


});
})(jQuery);
